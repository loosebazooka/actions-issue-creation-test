name: "Temporary placeholder for release issue creation to be merged into the release action"
on:
  workflow_dispatch:
    inputs:
      project:
        description: Jib project to release
        required: true
        default: (build-plan | core | maven | gradle | extension-common | maven-extension | gradle-extension)
      release_version:
        description: new release version
        required: true
        default: (for example, 0.1.0)

jobs:
  createissue:
    name: "Creating tracking issue for release"
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Parse Project
        run: |
          PROJECT=$( case ${{ github.event.inputs.project }} in
            extension-common) echo jib-plugins-extension-common ;;
            maven-extension)  echo jib-maven-plugin-extension-api ;;
            gradle-extension) echo jib-gradle-plugin-extension-api ;;
            maven|gradle)     echo jib-${{ github.event.inputs.project }}-plugin ;;
            *)                echo jib-${{ github.event.inputs.project }} ;;
          esac )
          echo "PROJECT_NAME=${PROJECT}" >> $GITHUB_ENV

      - name: Draft Maven/Gradle GitHub release
        uses: actions/create-release@v1
        id: create_release
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: v${{ github.event.inputs.release_version }}-${{ github.event.inputs.project }}
          release_name: ${{ env.PROJECT }} v${{ github.event.inputs.release_version }}
          draft: true
          body: |
            Some nonsense
        
      - uses: JasonEtco/create-an-issue@v2
        env:
         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
         RELEASE_NAME: v${{ github.event.inputs.release_version }}-${{ github.event.inputs.project }}
         CHANGELOG_URL: https://github.com/GoogleContainerTools/jib/blob/master/${{ env.PROJECT_NAME }}/CHANGELOG.md
         README_URL: https://github.com/GoogleContainerTools/jib/blob/master/${{ env.PROJECT_NAME }}/README.md
         RELEASE_DRAFT: ${{ steps.create_release.outputs.html_url }}
         RELEASE_PR: ${{ 
        with:
          filename: .github/RELEASE/release_checklist.md
